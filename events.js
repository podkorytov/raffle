var db = require('./db_model.js');
var filesystem = require('./filesystem');

module.exports.raffleToAdmin = function(msg) {
//    io.emit('admin', 'Можно начать новый конкурс');
};

module.exports.raffleToRegister = function(msg) {
//    io.emit('registration', 'Регистрация открыта');
};

module.exports.adminToRegistration = function(msg) {
//    io.emit('registration', 'Регистрация приостановлена');
};

module.exports.adminToRaffle = function(msg, callback) {
    var type = msg.type;

    db.User.getRandom(function(err, docs) {
        var victorine = new db.Victorine({winner: docs[0], type: type, prize:'Iphone'});
        victorine.save(function(err) {
            if (err) {
                console.log(err);
            } else {
                console.log(victorine);
                callback(victorine);
            }
        });
    });
};

module.exports.registrationToAdmin = function(msg) {
 
};

module.exports.registrationToRaffle = function(msg, callback) {
    var img_name = msg.code + '.png';
    // var img_content = msg.img_content;
    var img_content = 'data:image/png;base64,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';

    filesystem.saveFromBase64(img_content, img_name, function(img_url) {
        msg.img_url = img_url;
        var user = new db.User(msg);
        user.save(function(err) {
            if (err) {
                console.log(err);
            } else {
                callback(user);
            }
        });
    });
};